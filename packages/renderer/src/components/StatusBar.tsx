import React, { useState, useEffect } from 'react';\nimport { AppState } from '../App';\n\ninterface StatusBarProps {\n  appState: AppState;\n  systemStatus: any;\n  error: string | null;\n  onClearError: () => void;\n}\n\nexport function StatusBar({ appState, systemStatus, error, onClearError }: StatusBarProps) {\n  const [currentTime, setCurrentTime] = useState<string>('');\n  const [showSystemInfo, setShowSystemInfo] = useState<boolean>(false);\n  \n  useEffect(() => {\n    // ç¾åœ¨æ™‚åˆ»ã‚’æ›´æ–°\n    const updateTime = () => {\n      setCurrentTime(new Date().toLocaleTimeString());\n    };\n    \n    updateTime();\n    const timer = setInterval(updateTime, 1000);\n    \n    return () => clearInterval(timer);\n  }, []);\n  \n  /**\n   * ã‚¢ãƒ—ãƒªçŠ¶æ…‹ã®ãƒ†ã‚­ã‚¹ãƒˆã¨ã‚¢ã‚¤ã‚³ãƒ³ã‚’å–å¾—\n   */\n  const getAppStateInfo = () => {\n    switch (appState) {\n      case 'idle':\n        return { icon: 'ğŸ’¤', text: 'Ready', color: '#2196F3' };\n      case 'importing':\n        return { icon: 'ğŸ“‚', text: 'Files Imported', color: '#FF9800' };\n      case 'processing':\n        return { icon: 'âš¡', text: 'Processing...', color: '#4CAF50' };\n      case 'completed':\n        return { icon: 'âœ…', text: 'Completed', color: '#4CAF50' };\n      case 'error':\n        return { icon: 'âŒ', text: 'Error', color: '#F44336' };\n      default:\n        return { icon: 'â“', text: 'Unknown', color: '#757575' };\n    }\n  };\n  \n  /**\n   * ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ\n   */\n  const formatMemoryUsage = (bytes: number): string => {\n    const mb = bytes / (1024 * 1024);\n    return `${mb.toFixed(1)} MB`;\n  };\n  \n  /**\n   * ã‚¢ãƒƒãƒ—ã‚¿ã‚¤ãƒ ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ\n   */\n  const formatUptime = (seconds: number): string => {\n    const hours = Math.floor(seconds / 3600);\n    const minutes = Math.floor((seconds % 3600) / 60);\n    const secs = Math.floor(seconds % 60);\n    \n    if (hours > 0) {\n      return `${hours}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n    } else {\n      return `${minutes}:${secs.toString().padStart(2, '0')}`;\n    }\n  };\n  \n  /**\n   * ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹\n   */\n  const getSystemHealth = () => {\n    if (!systemStatus) return { status: 'unknown', color: '#757575' };\n    \n    const components = systemStatus.components || {};\n    const allComponentsHealthy = Object.values(components).every(status => status === true);\n    \n    if (allComponentsHealthy) {\n      return { status: 'healthy', color: '#4CAF50' };\n    } else {\n      return { status: 'warning', color: '#FF9800' };\n    }\n  };\n  \n  const appStateInfo = getAppStateInfo();\n  const systemHealth = getSystemHealth();\n  \n  return (\n    <div className=\"status-bar\">\n      {/* å·¦å´: ã‚¢ãƒ—ãƒªçŠ¶æ…‹ */}\n      <div className=\"status-left\">\n        <div className=\"app-status\">\n          <span \n            className=\"status-indicator\"\n            style={{ color: appStateInfo.color }}\n          >\n            {appStateInfo.icon}\n          </span>\n          <span className=\"status-text\">{appStateInfo.text}</span>\n        </div>\n        \n        {/* ã‚¨ãƒ©ãƒ¼è¡¨ç¤º */}\n        {error && (\n          <div className=\"error-status\">\n            <span className=\"error-icon\">âš ï¸</span>\n            <span className=\"error-text\">{error}</span>\n            <button \n              className=\"clear-error-button\"\n              onClick={onClearError}\n              title=\"Clear error\"\n            >\n              âœ•\n            </button>\n          </div>\n        )}\n      </div>\n      \n      {/* ä¸­å¤®: ã‚·ã‚¹ãƒ†ãƒ æƒ…å ± */}\n      <div \n        className=\"status-center\"\n        onClick={() => setShowSystemInfo(!showSystemInfo)}\n        title=\"Click for system details\"\n      >\n        <div className=\"system-status\">\n          <span \n            className=\"system-indicator\"\n            style={{ color: systemHealth.color }}\n          >\n            â—\n          </span>\n          <span className=\"system-text\">\n            AutoEditTATE {systemStatus?.version || 'v1.0.0'}\n          </span>\n        </div>\n        \n        {/* ã‚·ã‚¹ãƒ†ãƒ è©³ç´°ï¼ˆå±•é–‹æ™‚ï¼‰ */}\n        {showSystemInfo && systemStatus && (\n          <div className=\"system-details\">\n            <div className=\"system-detail-item\">\n              <span className=\"detail-label\">Memory:</span>\n              <span className=\"detail-value\">\n                {formatMemoryUsage(systemStatus.memory?.used || 0)} / \n                {formatMemoryUsage(systemStatus.memory?.total || 0)}\n              </span>\n            </div>\n            <div className=\"system-detail-item\">\n              <span className=\"detail-label\">Uptime:</span>\n              <span className=\"detail-value\">\n                {formatUptime(systemStatus.uptime || 0)}\n              </span>\n            </div>\n            <div className=\"system-detail-item\">\n              <span className=\"detail-label\">Components:</span>\n              <div className=\"components-status\">\n                {Object.entries(systemStatus.components || {}).map(([name, status]) => (\n                  <span \n                    key={name}\n                    className={`component-status ${status ? 'healthy' : 'error'}`}\n                    title={`${name}: ${status ? 'OK' : 'Error'}`}\n                  >\n                    {status ? 'âœ“' : 'âœ—'} {name}\n                  </span>\n                ))}\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n      \n      {/* å³å´: æ™‚åˆ»ã¨è¿½åŠ æƒ…å ± */}\n      <div className=\"status-right\">\n        <div className=\"time-display\">\n          <span className=\"time-icon\">ğŸ•</span>\n          <span className=\"time-text\">{currentTime}</span>\n        </div>\n        \n        {/* å‡¦ç†ä¸­ã®å ´åˆã€ç°¡æ˜“ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ */}\n        {appState === 'processing' && (\n          <div className=\"processing-indicator\">\n            <div className=\"processing-spinner\"></div>\n            <span className=\"processing-text\">Processing...</span>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}